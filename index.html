<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DragonShield to Moxfield</title>
  </head>
  <body>
    <h2>DragonShield to Moxfield conversion</h2>
    <input type="file" id="fileInput" accept=".csv" /><br /><br />
    <button onclick="convertToCSV()">Convert to Moxfield CSV</button>

    <script>
      function convertToCSV() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        if (!file) {
          alert('Please select a file.');
          return;
        }

        const reader = new FileReader();
        reader.onload = function (event) {
          const text = event.target.result;
          const convertedCSV = convertCSV(text);
          downloadCSV(convertedCSV);
        };
        reader.readAsText(file);
      }

      function convertCSV(csvText) {
        const lines = csvText.split('\n');
        const moxfieldHeaders = [
          'Count',
          'Name',
          'Edition',
          'Condition',
          'Language',
          'Foil',
          'Collector Number',
          'Alter',
          'Proxy',
          'Purchase Price',
        ];
        const convertedLines = [];

        for (let line of lines) {
          const match = line.match(/"([^"]*)"/);

          if (match) {
            const name = match[1];
            const sanitizeName = line.replace('"' + name + '",', '');
            const data = sanitizeName.split(',');

            if (data[0] == 'Quantity' || backsideCards(name)) {
              continue;
            }

            const convertedData = {
              [moxfieldHeaders[0]]: data[0],
              [moxfieldHeaders[1]]: '"' + name + '"',
              [moxfieldHeaders[2]]: data[2],
              [moxfieldHeaders[3]]: moxfieldCondition(data[6]),
              [moxfieldHeaders[4]]: data[7],
              [moxfieldHeaders[5]]: moxfieldFoil(data[5]),
              [moxfieldHeaders[6]]: '',
              [moxfieldHeaders[7]]: '',
              [moxfieldHeaders[8]]: '',
              [moxfieldHeaders[9]]: data[4],
            };
            convertedLines.push(convertedData);
          } else {
            //no matches found
          }
        }

        let convertedCSV = moxfieldHeaders.join(',') + '\n';

        for (let data of convertedLines) {
          convertedCSV += Object.values(data).join(',') + '\n';
        }

        return convertedCSV;
      }

      function backsideCards(name) {
        // For some reason, DragonShield includes the backside of cards as an entry in your collection export
        //    which then causes a duplicate importing to Moxfield
        if (
          name === 'Liliana, Defiant Necromancer' ||
          name === 'Chandra, Roaring Flame' ||
          name === 'Gideon, Battle-Forged' ||
          name === 'Jace, Telepath Unbound' ||
          name === 'Nissa, Sage Animist' ||
          name === 'A-Hakka, Whispering Raven' ||
          name === 'Perfected Form' ||
          name === 'A-Spectral Binding' ||
          name === 'A-Brinebound Gift' ||
          name === 'Infectious Curse' ||
          name === 'Temple of the Dead' ||
          name === 'A-Departed Soulkeeper' ||
          name === "A-Dorothea's Retribution" ||
          name === 'Gitaxian Mindstinger' ||
          name === 'Werewolf Ransacker' ||
          name === 'Agadeem, the Undercrypt' ||
          name === 'A-Gutter Shortcut' ||
          name === 'Ajani, Nacatl Avenger' ||
          name === 'Akoum Teeth' ||
          name === "A-Latern's Lift" ||
          name === 'Deadly Dancer' ||
          name === 'Hakka, Whispering Raven' ||
          name === 'Wretched Bonemass' ||
          name === 'Seasoned Cathar' ||
          name === 'A-Catlike Curiosity' ||
          name === 'Arcee, Acrobatic Coupe' ||
          name === 'Avacyn, the Purifier' ||
          name === 'Temple of Aclazotz' ||
          name === 'Arlinn, Embraced by the Moon' ||
          name === "Arlinn, the Moon's Fury" ||
          name === 'A-Will, Scholar of Frost' ||
          name === 'Echoing EquationEchoing Equation' ||
          name === 'Ancient of the Equinox' ||
          name === 'Hollowhenge Huntmaster' ||
          name === 'Lunarch Inquisitors' ||
          name === 'Ayara, Furnace Queen' ||
          name === 'Sanctum of the Sun' ||
          name === 'Likeness of the Seeker' ||
          name === 'Hook-Haunt Drifter' ||
          name === 'Bala Ged Sanctuary' ||
          name === 'Ballista Wielder' ||
          name === 'Baneclaw Marauder' ||
          name === 'Imperial Moth' ||
          name === 'Vision of the Unspeakable' ||
          name === 'Generous Soul' ||
          name === 'Dauntless Avenger' ||
          name === 'Beyeen Coast' ||
          name === 'Spectral Binding' ||
          name === 'Biolume Serpent' ||
          name === 'Wing Shredder' ||
          name === 'Harnfel, Horn of Bounty' ||
          name === 'Blackbloom Bog' ||
          name === 'Blaster, Morale Booster' ||
          name === 'Search for Blex' ||
          name === 'Blightsower Thallid' ||
          name === 'Searstep Pathway' ||
          name === 'Blitzwing, Adaptive Assailant' ||
          name === 'Lord of Lineage' ||
          name === 'Bloodsworn Knight' ||
          name === 'Plated Kilnbeast' ||
          name === 'Branch of Boseiju' ||
          name === 'Braided Quipu' ||
          name === 'Boulderloft Pathway' ||
          name === 'Tecutlan, the Searing Rift' ||
          name === 'Neck Breaker' ||
          name === 'Grimclimb Pathway' ||
          name === 'Brinebound Gift' ||
          name === 'Moonrage Brute' ||
          name === 'Dire-Strain Demolisher' ||
          name === 'Compleated Conjurer' ||
          name === 'Catapult Captain' ||
          name === 'Chalice of Death' ||
          name === 'Chandra, Roaring Flame' ||
          name === 'Chapel Shieldgeist' ||
          name === 'Savage PackmateSavage Packmate' ||
          name === "Markov's Servant" ||
          name === 'Homicidal Brute' ||
          name === 'Cosmium Kiln' ||
          name === 'Murkwater Pathway' ||
          name === 'Unholy Fiend' ||
          name === 'Revealing Eye' ||
          name === 'Conduit of Emrakul' ||
          name === "Conqueror's Foothold" ||
          name === 'Branded Howler' ||
          name === 'The Omenkeel' ||
          name === 'Covetous Geist' ||
          name === 'Ghostly Castigator' ||
          name === 'Aurora of Emrakul' ||
          name === 'Voracious Reader' ||
          name === 'Leeching Lurker' ||
          name === 'Cyclonus, Cybertronian Fighter' ||
          name === 'Bearer of Overwhelming Truths' ||
          name === 'Slitherbore Pathway' ||
          name === 'Nightfall Predator' ||
          name === 'Deathbonnet Hulk' ||
          name === 'Insectile Aberration' ||
          name === 'Dennick, Pious Apparition' ||
          name === 'Depraved Harvester' ||
          name === 'Departed Soulkeeper' ||
          name === 'Dire Blunderbuss' ||
          name === 'Clever Distraction' ||
          name === 'Final Iteration' ||
          name === 'Doric, Owlbear Avenger' ||
          name === 'Gnarled Grovestrider' ||
          name === "Dorothea's Retribution" ||
          name === 'Lost ValeLost Vale' ||
          name === 'Geode Grotto' ||
          name === 'Drogskol Armaments' ||
          name === 'Krallenhorde Howler' ||
          name === 'Awoken Demon' ||
          name === "Edgar Markov's Coffin" ||
          name === 'Throne of Death' ||
          name === 'Withengar Unbound' ||
          name === 'The Argent Etchings' ||
          name === 'Insidious Mist' ||
          name === 'Emeria, Shattered Skyclave' ||
          name === 'Angelic Enforcer' ||
          name === 'Hand of Enlightenment' ||
          name === 'The Prismatic Bridge' ||
          name === 'Etali, Primal Sickness' ||
          name === 'Extricator of Flesh' ||
          name === 'Awaken the Blood Avatar' ||
          name === 'Apex Observatory' ||
          name === 'Reflection of Kiki-Jiki' ||
          name === "Sinner's Judgment" ||
          name === 'Fangblade Eviscerator' ||
          name === 'Fearsome Werewolf' ||
          name === 'Revel in Silence' ||
          name === 'Embodiment of Flame' ||
          name === 'Flamewar, Streetwise Operative' ||
          name === 'Forsaken Thresher' ||
          name === 'Waildrifter' ||
          name === 'Garruk, the Veil-Cursed' ||
          name === 'Gatstaf Ravagers' ||
          name === 'Gatstaf Howler' ||
          name === 'Vildin-Pack Alpha' ||
          name === 'Glasspool Shore' ||
          name === 'Chrome Host Hulk' ||
          name === 'Goldbug, Scrappy Scout' ||
          name === 'Gold-Forge Garrison' ||
          name === "Shadows' Lair" ||
          name === 'Graveyard Glutton' ||
          name === 'Grimlock, Ferocious King' ||
          name === 'Grisly Anglerfish' ||
          name === 'Krallenhorde Wantons' ||
          name === 'Itlimoc, Cradle of the Sun' ||
          name === 'Gutter Shortcut' ||
          name === 'Winged Temple of Orazca' ||
          name === 'Hagra Broodpit' ||
          name === 'Sword of the Realms' ||
          name === 'Westvale Cult Leader' ||
          name === 'Bane of Hanweir' ||
          name === 'Phyrexian Skyflayer' ||
          name === 'Scrounged Scythe' ||
          name === 'Harvesttide Assailant' ||
          name === 'Havengul Mystery' ||
          name === 'Inherited Fiend' ||
          name === 'Heir to the Night' ||
          name === 'Heliod, the Warped Eclipse' ||
          name === 'Henrika, Infernal Seer' ||
          name === 'Malady Invoker' ||
          name === 'Lone Wolf of the Natterknolls' ||
          name === 'Vessel of the All-Consuming' ||
          name === 'Hinterland Scourge' ||
          name === 'Timber Shredder' ||
          name === 'Riphook Raider' ||
          name === 'Creeping Inn' ||
          name === 'Untamed Pup' ||
          name === 'Wildsong Howler' ||
          name === 'Roar of the Fifth People' ||
          name === 'Ravager of the Fells' ||
          name === "Sovereign's Macuahuitl" ||
          name === 'Howlpack Avenger' ||
          name === 'Infested Werewolf' ||
          name === 'Malicious Invader' ||
          name === 'Wildblood Pack' ||
          name === 'Awaken the Maelstrom' ||
          name === 'Lazotep Convert' ||
          name === 'Invocation of the Founders' ||
          name === 'Ashen Reaper' ||
          name === 'Belenon War Anthem' ||
          name === 'Serra Faithkeeper' ||
          name === 'Prickle Faeries' ||
          name === 'Truga Cliffcharger' ||
          name === 'Marchesa, Resolute Monarch' ||
          name === 'Lightshield Array' ||
          name === 'Zilortha, Apex of Ikoria' ||
          name === 'Deluge of the Dead' ||
          name === 'Belligerent Regisaur' ||
          name === 'Aetherwing, Golden-Scale Flagship' ||
          name === 'Pyre of the World Tree' ||
          name === 'Rooftop Saboteurs' ||
          name === 'Refraction Elemental' ||
          name === "Valor's Reach Tag Team" ||
          name === 'Winnowing Forces' ||
          name === 'Kyren Flamewright' ||
          name === 'Bloomwielder Dryads' ||
          name === 'Primordial Plasm' ||
          name === 'Holy Frazzle-Cannon' ||
          name === 'Teferi Akosa of Zhalfir' ||
          name === 'Gargantuan Slabhorn' ||
          name === 'Guildpact Paragon' ||
          name === 'Disciples of the Inferno' ||
          name === 'Caetus, Sea Tyrant of Segovia' ||
          name === 'Leyline Surge' ||
          name === 'Defiant Thundermaw' ||
          name === 'Ephara, Ever-Sheltering' ||
          name === 'The Broken Sky' ||
          name === 'Grandmother Ravi Sengir' ||
          name === 'Overloaded Mage-Ring' ||
          name === 'Vertex Paladin' ||
          name === 'Awakened Skyclave' ||
          name === 'Living Breakthrough' ||
          name === 'Iceberg Titan' ||
          name === 'Jace, Telepath Unbound' ||
          name === "Hauken's Insight" ||
          name === 'Jadeheart Attendant' ||
          name === 'Journey to the Oracle' ||
          name === 'Ormendahl, the Corrupter' ||
          name === 'Jetfire, Air Guardian' ||
          name === 'The Great Synthesis' ||
          name === 'Kaldring, the Rimestaff' ||
          name === 'Atzal, Cave of Eternity' ||
          name === 'Remnant of the Rising Star' ||
          name === 'Kabira Plateau' ||
          name === 'Jwari Ruins' ||
          name === "Kaslem's Strider" ||
          name === "Katilda's Rising Dawn" ||
          name === 'Kazandu Valley' ||
          name === "Kazuul's Cliffs" ||
          name === 'Flameheart Werewolf' ||
          name === 'Lord of the Ulvenwald' ||
          name === 'Sinuous Predator' ||
          name === 'Khalni Territory' ||
          name === 'Gitaxian Spellstalker' ||
          name === 'Imbraham, Dean of Theory' ||
          name === "Ancestor's Embrace" ||
          name === 'Demon-Possessed Witch' ||
          name === 'The Ringhart Crest' ||
          name === 'Terror of Kruin Pass' ||
          name === 'Etching of Kumano' ||
          name === 'Gideon, Battle-Forged' ||
          name === 'Silverpelt Werewolf' ||
          name === 'Lambholt Butcher' ||
          name === 'Lambholt Ravager' ||
          name === "Lanterns' Lift" ||
          name === 'Adanto, the First Fort' ||
          name === 'Memory of Toshiro' ||
          name === 'Liliana, Defiant Necromancer' ||
          name === 'Guidestone Compass' ||
          name === 'It That Rides as One' ||
          name === 'Unhallowed Cathar' ||
          name === "Olag, Ludevic's Hubris" ||
          name === "Ludevic's Abomination" ||
          name === 'Luminous Phantom' ||
          name === 'Makindi Mesas' ||
          name === 'Malakir Mire' ||
          name === 'Benevolent Geist' ||
          name === "Master's Manufactory" ||
          name === 'The Core' ||
          name === 'Howlpack Alpha' ||
          name === 'Megatron, Destructive Force' ||
          name === 'Portrait of Michiko' ||
          name === 'Lukka, Wayward Bonder' ||
          name === 'Ghastly Mimicry' ||
          name === 'Catlike Curiosity' ||
          name === "Tovolar's Magehunter" ||
          name === 'Morning Apparition' ||
          name === 'Chilling Chronicle' ||
          name === 'Mystic Monstrosity' ||
          name === 'Ashmouth Blade' ||
          name === 'Pillarverge Pathway' ||
          name === 'Hideous Fleshwheeler' ||
          name === 'Nicol Bolas, the Arisen' ||
          name === 'Princess Luna' ||
          name === 'Nissa, Sage Animist' ||
          name === 'Moonlit Ambusher' ||
          name === 'Temple of Power' ||
          name === 'Temple of Cultivation' ||
          name === 'Temple of Cyclical Time' ||
          name === 'Temple of Civilization' ||
          name === 'Nezumi Road Captain' ||
          name === 'Optimus Prime, Autobot Leader' ||
          name === 'Ondu Skyruins' ||
          name === 'Order of the Alabaster Host' ||
          name === 'Cosmium Catalyst' ||
          name === 'Oteclan Levitator' ||
          name === 'Frenzied Trapbreaker' ||
          name === 'Archive Haunt' ||
          name === 'Dinosaur Headdress' ||
          name === 'Cackling Culprit' ||
          name === 'Metzali, Tower of Triumph' ||
          name === 'Pelakka Caverns' ||
          name === 'Restorative Burst' ||
          name === 'Wayward Disciple' ||
          name === 'Augusta, Dean of Order' ||
          name === 'Polukranos, Engine of Ruin' ||
          name === 'Poppet Factory' ||
          name === 'Primal Wellspring' ||
          name === 'Tomb of the Dusk Rose' ||
          name === 'Prowl, Pursuit Vehicle' ||
          name === 'Glistening Goremonger' ||
          name === 'Radiant Restraints' ||
          name === 'Odious Witch' ||
          name === 'Rahilda, Feral Outlaw' ||
          name === 'Ratchet, Rescue Racer' ||
          name === 'Archdemon of Greed' ||
          name === 'Storm-Charged Slasher' ||
          name === 'Merciless Predator' ||
          name === "Valkmira, Protector's Shield" ||
          name === 'Bloodsoaked Reveler' ||
          name === 'Lavaglide Pathway' ||
          name === 'Rona, Tolarian Obliterator' ||
          name === 'Will, Scholar of Frost' ||
          name === 'Krothuss, Lord of the Deep' ||
          name === 'Werewolf of Ancient Hunger' ||
          name === 'Mastercraft Raptor' ||
          name === 'Moonscarred Werewolf' ||
          name === 'Stalking Vampire' ||
          name === 'Sea Gate, Reborn' ||
          name === 'Azcanta, the Sunken Ruin' ||
          name === 'Deadly Vanity' ||
          name === 'Sejiri Glacier' ||
          name === 'Seraph of New Phyrexia' ||
          name === 'Stalking Predator' ||
          name === 'Embrose, Dean of Shadow' ||
          name === 'Shatterskull, the Hammer Pass' ||
          name === 'The True Scriptures' ||
          name === 'Howling Chorus' ||
          name === 'Silundi Isle' ||
          name === 'Skin Shedder' ||
          name === 'Skyclave Invader' ||
          name === 'Skyclave Basilica' ||
          name === 'Slicer, High-Speed Antagonist' ||
          name === 'Ashmouth Dragon' ||
          name === 'Erupting Dreadwolf' ||
          name === 'One of the Pack' ||
          name === 'Song-Mad Ruins' ||
          name === 'Cipherbound Spirit' ||
          name === 'Ghastly Haunting' ||
          name === 'Soundwave, Superior Captain' ||
          name === 'Spellrune Howler' ||
          name === 'Spikefield Cave' ||
          name === 'Bladewheel Chariot' ||
          name === 'Starscream, Seeker Leader' ||
          name === 'Persistent Nightmare' ||
          name === 'Vault of Catlacan' ||
          name === 'Sunbird Effigy' ||
          name === 'Furnace-Blessed Conqueror' ||
          name === 'Seafaring Werewolf' ||
          name === "Seshiro's Living Legacy" ||
          name === 'Fibrous Entangler' ||
          name === 'Tangled Vale' ||
          name === 'The Tomb of Aclazotz' ||
          name === 'Burnished Dunestomper' ||
          name === 'Tavern Smasher' ||
          name === 'Kirin-Touched Orochi' ||
          name === "Tergrid's Lantern" ||
          name === 'The Golden-Gear Colossus' ||
          name === 'Spires of Orazca' ||
          name === "Dragon-Kami's Egg" ||
          name === 'Locus of Enlightenment' ||
          name === 'The Myriad Pools' ||
          name === 'Fragment of Konda' ||
          name === 'O-Kagachi Made Manifest' ||
          name === "Animus of Night's Reach" ||
          name === 'Vector Glider' ||
          name === 'Architect of Restoration' ||
          name === 'Nameless Conqueror' ||
          name === 'Awoken Horror' ||
          name === 'Barracks of the Thousand' ||
          name === 'Thraben Militia' ||
          name === 'Stonewing Antagonizer' ||
          name === 'The Grim Captain' ||
          name === 'Dire-Strain Brawler' ||
          name === 'Consuming Sepulcher' ||
          name === "Toralf's Hammer" ||
          name === 'Rampaging Werewolf' ||
          name === 'Flamethrower Sonata' ||
          name === 'Tovolar, the Midnight Scourge' ||
          name === "Tovolar's Packleader" ||
          name === 'Incited Rabble' ||
          name === 'Treasure Cove' ||
          name === "Echo of Death's Wail" ||
          name === 'Turntimber, Serpentine Wood' ||
          name === 'Twinblade Invocation' ||
          name === 'Mycoid Maze' ||
          name === 'Ulrich, Uncontested Alpha' ||
          name === 'Ultra Magnus, Armored Carrier' ||
          name === 'Ulvenwald Primordials' ||
          name === 'Ulvenwald Abomination' ||
          name === 'Ulvenwald Behemoth' ||
          name === 'Umara Skyfalls' ||
          name === 'Unimpeded Trespasser' ||
          name === 'Sandswirl Wanderglyph' ||
          name === 'The Great Work' ||
          name === 'Nassari, Dean of Expression' ||
          name === 'Valakut Stoneforge' ||
          name === 'Lisette, Dean of the Root' ||
          name === 'Tibalt, Cosmic Impostor' ||
          name === 'Spitfire Bastion' ||
          name === 'Vastwood Thicket' ||
          name === 'Strangling Grasp' ||
          name === 'Dronepack Kindred' ||
          name === 'Ironfang' ||
          name === 'Moonrise Intruder' ||
          name === 'Dread Osseosaur' ||
          name === 'Village Reavers' ||
          name === 'Howlpack of Estwald' ||
          name === 'Dire-Strain Anarchist' ||
          name === 'Bloodbat Summoner' ||
          name === 'Abolisher of Bloodlines' ||
          name === 'Volt-Charged Berserker' ||
          name === 'The Grand Evolution' ||
          name === 'Explore the Vastlands' ||
          name === 'Watertight Gondola' ||
          name === 'Blossom-Clad Werewolf' ||
          name === 'Wrathful Jailbreaker' ||
          name === 'Wedding Festivity' ||
          name === 'Jurassic Park' ||
          name === 'Ormendahl, Profane Prince' ||
          name === 'Krallenhorde Killer' ||
          name === 'Wedding Crasher' ||
          name === 'Zndrsplt, Eye of Wisdom' ||
          name === 'Zof Bloodbog'
        ) {
          return true;
        }
        return false;
      }

      function moxfieldCondition(dragonShieldCondition) {
        if (dragonShieldCondition == 'NearMint') {
          return 'NM';
        } else if (dragonShieldCondition == 'LightlyPlayed') {
          return 'LP';
        } else if (dragonShieldCondition == 'HeavilyPlayed') {
          return 'HP';
        }
        return dragonShieldCondition;
      }

      function moxfieldFoil(dragonShieldFoil) {
        if (dragonShieldFoil === 'true') {
          return 'foil';
        }
        return '';
      }

      function downloadCSV(csvContent) {
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'moxfield.csv';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
      }
    </script>
  </body>
</html>
